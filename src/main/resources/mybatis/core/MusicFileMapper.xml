<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kxai.qms.core.dao.MusicFileDao">

    <!-- 根据音乐ID查找列表 -->
    <select id="findListByMusicId" parameterType="int" resultType="MusicFile">
        SELECT
            file_id   AS fileId,
            music_id  AS musicId,
            music_bit AS musicBit,
            music_uri AS musicUri,
            music_ext AS musicExt,
            size,
            duration
        FROM qms_music_file
        WHERE music_id = #{musicId}
        ORDER BY music_bit ASC
    </select>

    <!-- 根据音乐ID删除音乐文件 -->
    <delete id="deleteByMusicId" parameterType="int">
        DELETE FROM qms_music_file
        WHERE music_id = #{musicId}
    </delete>

    <!-- 保存 -->
    <insert id="save" parameterType="MusicFile">
        INSERT INTO qms_music_file (file_id, music_id, music_bit, music_uri, music_ext, duration, size, create_time) VALUES (#{fileId}, #{musicId}, #{musicBit}, #{musicUri}, #{musicExt}, #{duration}, #{size}, #{createTime})
        ON DUPLICATE KEY UPDATE music_uri = #{musicUri}, music_ext = #{musicExt}, duration = #{duration}, size = #{size}
    </insert>

    <!-- 根据文件ID删除音乐文件 -->
    <delete id="deleteByFileId" parameterType="int">
        DELETE FROM qms_music_file
        WHERE file_id = #{fileId}
    </delete>
</mapper>